# 要件定義書

## 1. アプリ概要
「4Seasnap」は、季節を感じる行動を記録し、散歩や外出のモチベーションを高める Web アプリです。  
ユーザーは「季節のキーワード」をもとにおすすめスポットを検索・AI推薦から探し、実際に訪れて記録を残すことで、カレンダーにスタンプを埋める体験を楽しめます。  
パニック障害など外出に不安を感じる人のリハビリ的活用も想定しています。

---

## 2. コンセプト
- **季節を感じる**：食べ物・花・景色・イベントをきっかけに外出
- **今を楽しむ**：その日の記録を残して思い出化
- **外出のモチベーション**：スタンプやシールを集めるような体験
- **シンプル操作**：検索や登録の手間を最小限に
- **AIの活用**：スポット選びの負担を軽減し、レコメンドで新しい発見を提供

---

## 3. 主な機能

### 3.1 カレンダー & スタンプ
- 月ごとのカレンダー表示
- 投稿（日付・写真・感想・歩数）を登録するとスタンプが押される
- 季節ごとにカレンダー背景色を変更（例：春=桜色、夏=青、秋=紅葉、冬=雪）
- 過去の記録の閲覧期間制限なし
- 基本月表示で、日付押下で詳細確認可能

### 3.2 季節のキーワード提示
- 管理者が用語を設定（月ごとに5個程度）
- アプリ内で一覧提示し、ユーザーが気になるものを選択
- 選択すると以下の動作が可能：
  - Google検索へ遷移
  - Google Mapsへ遷移
  - **AIによるおすすめスポットリスト（3-5個）を表示**

### 3.3 検索・スポット表示
- Google検索連携：季節キーワード＋補助ワードで検索
- Google Maps連携：店舗やスポットを表示、距離を把握
- **AIレコメンド**：
  - 季節ワードを入力に取り、ジャンルを分類
  - 現在地（GPS自動取得、失敗時は手動入力）から行きやすいスポット3-5個を推薦
  - ユーザーがワードを押して実行ボタン押下時にリアルタイム生成

### 3.4 歩数・距離・移動手段
- Google Maps Directions API を使い、スタート地点から目的地までの実際のルート距離・所要時間を取得
- 移動手段の選択：徒歩・自転車・公共交通機関・車（デフォルト：徒歩）
- 自動入力候補を提示、手動修正も可能

### 3.5 記録機能
- 写真：デフォルト季節画像（春夏秋冬各1枚）+ カメラロールから選択
- コメント入力
- 歩数 or 移動時間入力（推定値 or 手入力）
- 1日複数回の記録が可能
- 記録はカレンダーに反映
- 記録の編集・削除機能（将来実装予定）

---

## 4. 技術スタック

### 4.1 基盤技術
- **フロントエンド**: Next.js (TypeScript)
- **バックエンド**: Supabase (DB, Auth, Storage)
- **デプロイ**: Vercel

### 4.2 外部API
- **AI**: Google Gemini 2.0 Flash（無料版）
- **地図**: Google Maps Directions API（無料枠内）
- **検索**: Google Search（外部リンク遷移）

### 4.3 認証システム
- Supabase匿名認証 + localStorage
- 端末ごとの自動ゲストユーザー登録
- 端末変更時のデータ引き継ぎは対象外

---

## 5. 画面フロー

### 5.1 ナビゲーション構成
- **ボトムナビゲーション**（スマホ向け）：
  - 「カレンダー」（トップ画面）
  - 「季節キーワード」
  - 「Wishリスト」

### 5.2 画面遷移フロー

#### 基本の利用フロー
1. **カレンダー画面（トップ）**  
   - 月ごとのカレンダー表示、スタンプ確認
   - 日付押下で詳細表示
   - ボトムナビから「季節キーワード」へ遷移

2. **季節キーワード画面**  
   - 季節ごとのキーワード一覧を表示（月ごとに5個）
   - 興味あるワードを選択 → **スポット選択画面**へ

3. **スポット選択画面**  
   - AIレコメンド表示（3-5個）
   - Google検索 / Google Maps へ遷移も可能
   - 各スポットで以下のアクション：
     - 「Wishリストに追加」→ **Wishリスト画面**へ
     - 「記録する」→ **記録登録画面**へ
     - 「地図で確認」→ Google Maps

4. **記録登録画面**  
   - 写真選択（デフォルト画像 or カメラロール）
   - 感想入力、歩数・移動時間入力
   - 登録完了 → **カレンダー画面**に戻る（スタンプ追加）

#### Wishリスト経由フロー
1. **Wishリスト画面**（ボトムナビから直接アクセス）
   - 保存したスポット一覧表示
   - 完了マーク・削除機能
   - 将来的に「記録する」→ **記録登録画面**への導線追加予定

#### 記録確認フロー
1. **カレンダー画面**
   - スタンプ付き日付をタップ → **記録詳細画面**
   - 過去の記録を閲覧可能

---

## 6. 想定ユーザー
- 季節を感じる散歩や外出を楽しみたい人
- 外出モチベーションを高めたい人
- パニック障害や不安障害を持ち、段階的に外出に慣れたい人
- 写真や記録をシール集め感覚で残したい人

---

## 7. デザイン方針
- **方向性**: シンプル系
- **季節テーマ**: 季節ごとにカラーテーマ変更
- **モバイルファースト**: スマートフォンブラウザでの利用を前提
- **操作性**: 登録操作は3ステップ以内

---

## 8. 季節キーワード初期データ

### 春（3-5月）
- 桜、花見、菜の花、いちご狩り、ピクニック

### 夏（6-8月）
- 花火、海、プール、かき氷、夏祭り

### 秋（9-11月）
- 紅葉、月見、ハロウィン、栗拾い、コスモス

### 冬（12-2月）
- クリスマス、雪、イルミネーション、温泉、梅

---

## 9. 非機能要件

### 9.1 パフォーマンス
- 初期ロード < 3秒
- 検索・AIレコメンド応答 < 5秒を目標
- 同時接続ユーザー 100人程度までを想定

### 9.2 セキュリティ
- Supabase Auth による匿名認証
- HTTPS必須
- APIキーはサーバーサイドで管理
- 画像アップロードは認証ユーザーのみ許可

### 9.3 コスト・運用
- 完全無料での運用
- Gemini 2.0 Flash（無料版）使用
- Phase 2でGoogle Maps Directions API（無料枠内）追加
- Supabase無料プラン範囲内

### 9.4 データ取り扱い
- 匿名ユーザーデータの適切な管理
- プライバシーポリシーの策定
- 画像データの適切な保存・管理

---

## 10. 開発計画

### 10.1 開発期間
- **総開発時間**: 30時間
- **開発ツール**: Claude Code使用

### 10.2 Phase 1 (MVP - 20時間)
1. 基本UI（カレンダー画面をトップに、ボトムナビゲーション）
2. Supabase匿名認証 + データ保存
3. 季節キーワード表示 + Gemini連携
4. 写真機能（デフォルト画像 + カメラロール選択）
5. 記録登録機能（手動入力のみ）

### 10.3 Phase 2 (追加機能 - 10時間)
1. **GPS自動取得** + Google Maps Directions API連携
2. **距離・時間自動計算機能**
3. **Wishリスト機能**（追加・削除・完了マーク）
4. UI/UX改善（季節テーマ等）
5. エラーハンドリング

---

## 11. 今後の拡張アイデア
- 他ユーザーの投稿をシェアするソーシャル機能
- バッジや実績アンロック機能でゲーミフィケーション強化
- 季節に応じた通知機能
- 正式ユーザー登録機能
- 記録の編集・削除機能
- Wishリストから直接記録登録機能